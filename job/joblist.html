<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="../style/style.css" />
  <link rel="stylesheet" href="./style/joblist/style.css" />
  <link rel="stylesheet" href="./style/job/job.css" />
  <title>군사특기 목록</title>
</head>

<body>

  <div class="mili_box">
    <div class="mili_selector">
      <li class="army mili_btn">육군</li>
      <li class="navy mili_btn">해군</li>
      <li class="airforce mili_btn">공군</li>
      <li class=" navy2 mili_btn">해병대</li>
    </div>
  </div>

  <div class=" list_wrap">
    <div class="mili_img_box">
      <img src="./media/navy.jfif" alt="">
    </div>


    <div id="mos_list" class="list">
      <!---->


    </div>




  </div>



  </div>



  <!-- 
    background : #e6e9ed
    list : #e6e9ed

    육,해,공,해

    navy : rgba(163, 253, 181, 0.3);
    army : 
   -->
  <script src="./js/joblist/app.js" defer></script>
  <script src="../js/communication/app.js" type="module"></script>
  <script>

    let mili_btn = document.querySelectorAll('.mili_btn');

    mili_btn.forEach((e, index) => {
      e.addEventListener('click', () => {
        click_branch_btn(index + 1);

      })
    })



    let url_prefix = 'http://api.xn--o39a35bw4ff5gp5m354a.xn--3e0b707e:8000';
    let BRANCH = [, "육군", "해군", "공군", "해병대"];
    let data;
    let currentButton = null;
    let url = url_prefix + '/api/mos/';
    fetch(url)
      .then(function (response) {
        return response.json();
      })
      .then(function (json) {
        data = json;
        load();
      })

    function change(e, index) {

    }

    function click_branch_btn(branch) {
      if (currentButton == branch) {
        load();
      } else {
        load(branch);
      }
      //Todo 버튼효과 변경

    }


    function load(branch = null) {
      currentButton = branch;
      let mos_list = document.querySelector("#mos_list");
      mos_list.innerHTML = '';
      console.log('data:', data);
      for (const element of data) {
        if (element.branch == branch || !branch) {
          let li = document.createElement('li');
          li.setAttribute('class', 'list_box');
          li.setAttribute('onclick', 'location.href="/job/job.html#' + element.pk + '"');

          let span = document.createElement('span');
          span.setAttribute('class', 'idx');
          span.innerHTML = BRANCH[element.branch];

          let div = document.createElement('div');
          div.setAttribute('class', 'wrapper');


          let p = document.createElement('p');
          let codename = document.createElement('p');

          p.setAttribute('class', 'positionName');
          codename.setAttribute('class', 'codename');
          codename.innerHTML = `(${element.code})`
          p.innerHTML = element.name;







          li.appendChild(span);
          div.appendChild(codename);
          div.appendChild(p);

          div.innerHTML += '<span class="arrow_box"><img class="logo" src="./media/arrow.svg" alt="" class="href_btn"></span>';

          li.appendChild(div);
          mos_list.appendChild(li);



        }

      }
    }
  </script>
</body>

</html>